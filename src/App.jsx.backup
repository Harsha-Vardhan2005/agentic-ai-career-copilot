import React, { useState, createContext, useContext, useEffect } from 'react';
import { User, Target, TrendingUp, Users, BookOpen, CheckCircle, XCircle, Clock, ArrowRight, LogOut, Menu, X, Upload, Sparkles, Plus, Search, FileText, Zap, Award, Briefcase, GraduationCap, Rocket } from 'lucide-react';

// ðŸ”¥ CONFIGURATION - PASTE YOUR KEYS HERE
const CONFIG = {
  GROQ_API_KEY: 'YOUR_GROQ_API_KEY_HERE',
  GROQ_API_URL: 'https://api.groq.com/openai/v1/chat/completions',
  GROQ_MODEL: 'mixtral-8x7b-32768'
};

// Context
const AppContext = createContext();
const useApp = () => useContext(AppContext);

// Mock Data
const AVAILABLE_MENTORS = [
  { id: 'm1', name: 'Priya Sharma', role: 'Senior SDE at Microsoft', avatar: 'PS', expertise: ['System Design', 'Cloud', 'Interview Prep'], experience: '8 years' },
  { id: 'm2', name: 'Rahul Mehta', role: 'ML Engineer at Meta', avatar: 'RM', expertise: ['Machine Learning', 'Python', 'Data Engineering'], experience: '6 years' },
  { id: 'm3', name: 'Ananya Gupta', role: 'Tech Lead at Google', avatar: 'AG', expertise: ['Full Stack', 'Leadership', 'Mentoring'], experience: '10 years' },
  { id: 'm4', name: 'Karthik Reddy', role: 'DevOps Engineer at Amazon', avatar: 'KR', expertise: ['AWS', 'Docker', 'CI/CD'], experience: '5 years' },
  { id: 'm5', name: 'Sneha Patel', role: 'Product Manager at Flipkart', avatar: 'SP', expertise: ['Product Strategy', 'Analytics', 'Growth'], experience: '7 years' }
];

const SAMPLE_APPLICATIONS = [
  { id: 1, company: 'Google', role: 'SWE Intern', status: 'rejected', date: '2025-01-15' },
  { id: 2, company: 'Amazon', role: 'SDE Intern', status: 'rejected', date: '2025-01-10' },
  { id: 3, company: 'Microsoft', role: 'Software Engineer', status: 'interview', date: '2025-01-20' },
  { id: 4, company: 'Meta', role: 'Frontend Engineer', status: 'applied', date: '2025-01-18' },
];

// GROQ API Helper
const callGroqAPI = async (prompt, maxTokens = 2000) => {
  if (!CONFIG.GROQ_API_KEY || CONFIG.GROQ_API_KEY === 'YOUR_GROQ_API_KEY_HERE') {
    throw new Error('Please add your GROQ API key in the CONFIG object at the top of the code!');
  }

  try {
    const response = await fetch(CONFIG.GROQ_API_URL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${CONFIG.GROQ_API_KEY}`
      },
      body: JSON.stringify({
        model: CONFIG.GROQ_MODEL,
        messages: [{ role: 'user', content: prompt }],
        temperature: 0.7,
        max_tokens: maxTokens
      })
    });

    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(errorData.error?.message || 'API request failed');
    }

    const data = await response.json();
    return data.choices[0].message.content;
  } catch (error) {
    console.error('GROQ API Error:', error);
    throw error;
  }
};

// Landing Page Component
const LandingPage = ({ onGetStarted }) => {
  const [animateCards, setAnimateCards] = useState(false);

  useEffect(() => {
    setTimeout(() => setAnimateCards(true), 100);
  }, []);

  const features = [
    { icon: Target, title: 'AI-Powered Roadmaps', desc: 'Get personalized career paths generated by advanced AI', color: 'from-blue-500 to-cyan-500' },
    { icon: Users, title: 'Smart Mentorship', desc: 'Connect with industry experts matched to your goals', color: 'from-purple-500 to-pink-500' },
    { icon: TrendingUp, title: 'Learn from Rejections', desc: 'Turn setbacks into comebacks with AI insights', color: 'from-orange-500 to-red-500' },
    { icon: FileText, title: 'Resume Analysis', desc: 'Get instant feedback on your resume from AI', color: 'from-green-500 to-emerald-500' }
  ];

  return (
    <div className="min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 relative overflow-hidden">
      {/* Animated Background */}
      <div className="absolute inset-0 opacity-20">
        <div className="absolute top-20 left-10 w-72 h-72 bg-blue-500 rounded-full blur-3xl animate-pulse"></div>
        <div className="absolute bottom-20 right-10 w-96 h-96 bg-purple-500 rounded-full blur-3xl animate-pulse delay-1000"></div>
        <div className="absolute top-1/2 left-1/2 w-80 h-80 bg-pink-500 rounded-full blur-3xl animate-pulse delay-2000"></div>
      </div>

      <div className="relative z-10 min-h-screen flex flex-col">
        {/* Header */}
        <header className="p-6">
          <div className="max-w-7xl mx-auto flex items-center justify-between">
            <div className="border-3 border-dashed border-indigo-300 rounded-2xl p-10 text-center bg-gradient-to-br from-indigo-50 to-purple-50 hover:border-indigo-500 transition">
              <Upload className="w-16 h-16 text-indigo-400 mx-auto mb-4" />
              <input
                type="file"
                accept=".pdf"
                onChange={(e) => setFile(e.target.files[0])}
                className="hidden"
                id="resume-upload"
              />
              <label htmlFor="resume-upload" className="cursor-pointer">
                <span className="text-indigo-600 font-bold text-lg hover:underline">Click to upload</span>
                <span className="text-gray-600"> or drag and drop</span>
              </label>
              <p className="text-sm text-gray-500 mt-2">PDF up to 10MB</p>
            </div>
            {file && (
              <div className="mt-4 flex items-center gap-3 p-4 bg-green-50 border-2 border-green-200 rounded-xl">
                <FileText className="w-6 h-6 text-green-600" />
                <span className="font-semibold text-green-900">{file.name}</span>
              </div>
            )}
          </div>

          {error && (
            <div className="mb-4 p-4 bg-red-50 border-l-4 border-red-500 rounded-xl text-red-700 font-medium">
              {error}
            </div>
          )}

          <button
            onClick={analyzeResume}
            disabled={!file || analyzing}
            className="w-full px-8 py-4 bg-gradient-to-r from-pink-600 to-red-600 text-white rounded-xl font-bold text-lg hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 shadow-2xl"
          >
            {analyzing ? (
              <>
                <div className="w-6 h-6 border-4 border-white border-t-transparent rounded-full animate-spin" />
                Analyzing your resume...
              </>
            ) : (
              <>
                <Sparkles className="w-6 h-6" />
                Analyze Resume
              </>
            )}
          </button>
        </div>

        {analysis && (
          <div className="space-y-6">
            <div className="bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl shadow-2xl p-8 text-white">
              <div className="text-center">
                <Award className="w-16 h-16 mx-auto mb-4 opacity-80" />
                <div className="text-6xl font-bold mb-2">{analysis.score}/10</div>
                <div className="text-green-100 text-lg font-semibold">Overall Resume Score</div>
              </div>
            </div>

            <div className="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-green-500">
              <h4 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                <CheckCircle className="w-6 h-6 text-green-500" />
                Strengths
              </h4>
              <ul className="space-y-3">
                {analysis.strengths.map((strength, idx) => (
                  <li key={idx} className="flex items-start gap-3 p-3 bg-green-50 rounded-lg">
                    <span className="text-green-600 font-bold text-xl">âœ“</span>
                    <span className="text-gray-700 font-medium">{strength}</span>
                  </li>
                ))}
              </ul>
            </div>

            <div className="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-orange-500">
              <h4 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                <TrendingUp className="w-6 h-6 text-orange-500" />
                Areas for Improvement
              </h4>
              <ul className="space-y-3">
                {analysis.improvements.map((improvement, idx) => (
                  <li key={idx} className="flex items-start gap-3 p-3 bg-orange-50 rounded-lg">
                    <span className="text-orange-600 font-bold text-xl">â†’</span>
                    <span className="text-gray-700 font-medium">{improvement}</span>
                  </li>
                ))}
              </ul>
            </div>

            <div className="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl shadow-2xl p-6 text-white">
              <h4 className="text-xl font-bold mb-4 flex items-center gap-2">
                <Target className="w-6 h-6" />
                Action Items
              </h4>
              <ul className="space-y-3">
                {analysis.actionItems.map((action, idx) => (
                  <li key={idx} className="flex items-start gap-3 p-3 bg-white bg-opacity-10 backdrop-blur-lg rounded-lg">
                    <span className="font-bold text-xl">{idx + 1}.</span>
                    <span className="font-medium">{action}</span>
                  </li>
                ))}
              </ul>
            </div>
          </div>
        )}
      </div>
    );
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100">
      {/* Header */}
      <header className="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm">
        <div className="px-4 sm:px-6 lg:px-8">
          <div className="flex items-center justify-between h-16">
            <div className="flex items-center gap-3">
              <button 
                onClick={() => setSidebarOpen(!sidebarOpen)}
                className="lg:hidden p-2 rounded-xl hover:bg-gray-100 transition"
              >
                {sidebarOpen ? <X className="w-6 h-6" /> : <Menu className="w-6 h-6" />}
              </button>
              <div className="flex items-center gap-2">
                <div className="w-10 h-10 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center">
                  <Target className="w-6 h-6 text-white" />
                </div>
                <span className="text-xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 text-transparent bg-clip-text">
                  Career Copilot
                </span>
              </div>
            </div>
            
            <div className="flex items-center gap-4">
              <div className="hidden sm:flex items-center gap-3 px-4 py-2 bg-gray-50 rounded-xl">
                <div className="w-10 h-10 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full flex items-center justify-center text-white font-bold">
                  {user.name.charAt(0)}
                </div>
                <div className="text-left">
                  <p className="text-sm font-bold text-gray-900">{user.name}</p>
                  <p className="text-xs text-gray-500">{user.email}</p>
                </div>
              </div>
              <button 
                onClick={logout}
                className="p-2.5 text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-xl transition"
                title="Logout"
              >
                <LogOut className="w-5 h-5" />
              </button>
            </div>
          </div>
        </div>
      </header>

      <div className="flex">
        {/* Sidebar */}
        <aside className={`${
          sidebarOpen ? 'translate-x-0' : '-translate-x-full'
        } lg:translate-x-0 fixed lg:static inset-y-0 left-0 z-40 w-64 bg-white border-r border-gray-200 transition-transform duration-300 ease-in-out mt-16 lg:mt-0 shadow-xl lg:shadow-none`}>
          <nav className="p-4 space-y-2">
            {navItems.map(item => (
              <button
                key={item.id}
                onClick={() => {
                  setView(item.id);
                  setSidebarOpen(false);
                }}
                className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left transition-all ${
                  view === item.id
                    ? 'bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg scale-105'
                    : 'text-gray-700 hover:bg-gray-50 hover:scale-102'
                }`}
              >
                <item.icon className={`w-5 h-5 ${view === item.id ? 'text-white' : item.color}`} />
                <span className="font-semibold">{item.label}</span>
              </button>
            ))}
          </nav>
        </aside>

        {/* Main Content */}
        <main className="flex-1 p-4 sm:p-6 lg:p-8">
          <div className="max-w-7xl mx-auto">
            {view === 'overview' && <OverviewView />}
            {view === 'roadmap' && <RoadmapView />}
            {view === 'applications' && <ApplicationsView />}
            {view === 'mentors' && <MentorsView />}
            {view === 'resume' && <ResumeAnalyzerView />}
          </div>
        </main>
      </div>
    </div>
  );
};

// Main App
export default function App() {
  const [appState, setAppState] = useState('landing');
  const [view, setView] = useState('overview');
  const [user, setUser] = useState(null);
  const [profileData, setProfileData] = useState(null);
  const [connectedMentors, setConnectedMentors] = useState([
    {
      id: 'm1',
      name: 'Priya Sharma',
      role: 'Senior SDE at Microsoft',
      avatar: 'PS',
      expertise: ['System Design', 'Cloud', 'Interview Prep'],
      matchReason: 'Works at FAANG, strong in system design',
      status: 'connected'
    }
  ]);

  const contextValue = {
    user,
    profileData,
    applications: SAMPLE_APPLICATIONS,
    connectedMentors,
    setConnectedMentors,
    view,
    setView,
    logout: () => {
      setAppState('landing');
      setUser(null);
      setProfileData(null);
    }
  };

  return (
    <AppContext.Provider value={contextValue}>
      {appState === 'landing' && <LandingPage onGetStarted={() => setAppState('auth')} />}
      {appState === 'auth' && (
        <AuthPage onAuthSuccess={(userData) => {
          setUser(userData);
          setAppState('onboarding');
        }} />
      )}
      {appState === 'onboarding' && (
        <Onboarding 
          userName={user.name} 
          onComplete={(data) => {
            setProfileData(data);
            setAppState('dashboard');
          }} 
        />
      )}
      {appState === 'dashboard' && <Dashboard />}
    </AppContext.Provider>
  );
}

  const [formData, setFormData] = useState({
    degree: '',
    year: '',
    careerRole: '',
    skills: [],
    hasProjects: null,
    hasInternships: null,
    certifications: ''
  });

  const degrees = ['B.Tech', 'M.Tech', 'BCA', 'MCA', 'MBA', 'B.Sc', 'M.Sc', 'Other'];
  const years = ['1st Year', '2nd Year', '3rd Year', 'Final Year', 'Recent Graduate', 'Working Professional'];
  const roles = ['Software Engineer', 'Data Scientist', 'ML Engineer', 'Cloud Engineer', 'DevOps Engineer', 'Full Stack Developer', 'Frontend Developer', 'Backend Developer', 'Research Analyst', 'Product Manager'];
  const skillOptions = ['Python', 'JavaScript', 'Java', 'C++', 'React', 'Node.js', 'AI/ML', 'Cloud (AWS/Azure)', 'Docker', 'Kubernetes', 'SQL', 'MongoDB', 'System Design', 'Data Structures'];

  const updateField = (field, value) => {
    setFormData(prev => ({ ...prev, [field]: value }));
  };

  const toggleSkill = (skill) => {
    setFormData(prev => ({
      ...prev,
      skills: prev.skills.includes(skill)
        ? prev.skills.filter(s => s !== skill)
        : [...prev.skills, skill]
    }));
  };

  const canProceed = () => {
    if (step === 1) return formData.degree && formData.year;
    if (step === 2) return formData.careerRole;
    if (step === 3) return formData.skills.length > 0;
    if (step === 4) return formData.hasProjects !== null && formData.hasInternships !== null;
    return true;
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4">
      <div className="bg-white rounded-3xl shadow-2xl p-8 w-full max-w-2xl border border-gray-100">
        <div className="mb-8">
          <div className="flex items-center justify-between mb-4">
            <h2 className="text-2xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 text-transparent bg-clip-text">
              Welcome, {userName}! ðŸ‘‹
            </h2>
            <span className="text-sm font-semibold text-gray-500">Step {step} of 4</span>
          </div>
          <div className="flex gap-2">
            {[1, 2, 3, 4].map(i => (
              <div key={i} className={`h-2 flex-1 rounded-full transition-all duration-300 ${
                i <= step ? 'bg-gradient-to-r from-indigo-600 to-purple-600' : 'bg-gray-200'
              }`} />
            ))}
          </div>
        </div>

        {step === 1 && (
          <div className="space-y-6">
            <div className="flex items-center gap-3 mb-4">
              <div className="w-12 h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center">
                <GraduationCap className="w-6 h-6 text-white" />
              </div>
              <h3 className="text-xl font-bold text-gray-800">Education Background</h3>
            </div>
            
            <div>
              <label className="block text-sm font-semibold text-gray-700 mb-2">Degree *</label>
              <select
                value={formData.degree}
                onChange={(e) => updateField('degree', e.target.value)}
                className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition"
              >
                <option value="">Select your degree</option>
                {degrees.map(d => <option key={d} value={d}>{d}</option>)}
              </select>
            </div>

            <div>
              <label className="block text-sm font-semibold text-gray-700 mb-2">Year / Status *</label>
              <select
                value={formData.year}
                onChange={(e) => updateField('year', e.target.value)}
                className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition"
              >
                <option value="">Select your year</option>
                {years.map(y => <option key={y} value={y}>{y}</option>)}
              </select>
            </div>
          </div>
        )}

        {step === 2 && (
          <div className="space-y-6">
            <div className="flex items-center gap-3 mb-4">
              <div className="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl flex items-center justify-center">
                <Target className="w-6 h-6 text-white" />
              </div>
              <h3 className="text-xl font-bold text-gray-800">Career Intent</h3>
            </div>
            <p className="text-gray-600">What role are you aiming for?</p>
            
            <div className="grid grid-cols-2 gap-3">
              {roles.map(role => (
                <button
                  key={role}
                  type="button"
                  onClick={() => updateField('careerRole', role)}
                  className={`p-4 rounded-xl border-2 text-left transition-all ${
                    formData.careerRole === role
                      ? 'border-indigo-600 bg-gradient-to-r from-indigo-50 to-purple-50 shadow-lg scale-105'
                      : 'border-gray-200 hover:border-indigo-300 hover:shadow'
                  }`}
                >
                  <div className="font-semibold text-gray-900">{role}</div>
                </button>
              ))}
            </div>
          </div>
        )}

        {step === 3 && (
          <div className="space-y-6">
            <div className="flex items-center gap-3 mb-4">
              <div className="w-12 h-12 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl flex items-center justify-center">
                <Zap className="w-6 h-6 text-white" />
              </div>
              <h3 className="text-xl font-bold text-gray-800">Your Skills</h3>
            </div>
            <p className="text-gray-600">Select all that apply</p>
            
            <div className="flex flex-wrap gap-3">
              {skillOptions.map(skill => (
                <button
                  key={skill}
                  type="button"
                  onClick={() => toggleSkill(skill)}
                  className={`px-4 py-2 rounded-full text-sm font-semibold transition-all ${
                    formData.skills.includes(skill)
                      ? 'bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg scale-105'
                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                  }`}
                >
                  {skill}
                </button>
              ))}
            </div>
          </div>
        )}

        {step === 4 && (
          <div className="space-y-6">
            <div className="flex items-center gap-3 mb-4">
              <div className="w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl flex items-center justify-center">
                <Briefcase className="w-6 h-6 text-white" />
              </div>
              <h3 className="text-xl font-bold text-gray-800">Experience</h3>
            </div>
            
            <div>
              <label className="block text-sm font-semibold text-gray-700 mb-3">Have you done any projects? *</label>
              <div className="grid grid-cols-2 gap-4">
                <button
                  type="button"
                  onClick={() => updateField('hasProjects', true)}
                  className={`p-6 rounded-xl border-2 transition-all ${
                    formData.hasProjects === true 
                      ? 'border-green-500 bg-green-50 shadow-lg scale-105' 
                      : 'border-gray-200 hover:border-green-300'
                  }`}
                >
                  <CheckCircle className={`w-8 h-8 mx-auto mb-2 ${formData.hasProjects === true ? 'text-green-500' : 'text-gray-400'}`} />
                  <div className="font-bold text-center">Yes</div>
                </button>
                <button
                  type="button"
                  onClick={() => updateField('hasProjects', false)}
                  className={`p-6 rounded-xl border-2 transition-all ${
                    formData.hasProjects === false 
                      ? 'border-red-500 bg-red-50 shadow-lg scale-105' 
                      : 'border-gray-200 hover:border-red-300'
                  }`}
                >
                  <XCircle className={`w-8 h-8 mx-auto mb-2 ${formData.hasProjects === false ? 'text-red-500' : 'text-gray-400'}`} />
                  <div className="font-bold text-center">No</div>
                </button>
              </div>
            </div>

            <div>
              <label className="block text-sm font-semibold text-gray-700 mb-3">Have you done any internships? *</label>
              <div className="grid grid-cols-2 gap-4">
                <button
                  type="button"
                  onClick={() => updateField('hasInternships', true)}
                  className={`p-6 rounded-xl border-2 transition-all ${
                    formData.hasInternships === true 
                      ? 'border-green-500 bg-green-50 shadow-lg scale-105' 
                      : 'border-gray-200 hover:border-green-300'
                  }`}
                >
                  <CheckCircle className={`w-8 h-8 mx-auto mb-2 ${formData.hasInternships === true ? 'text-green-500' : 'text-gray-400'}`} />
                  <div className="font-bold text-center">Yes</div>
                </button>
                <button
                  type="button"
                  onClick={() => updateField('hasInternships', false)}
                  className={`p-6 rounded-xl border-2 transition-all ${
                    formData.hasInternships === false 
                      ? 'border-red-500 bg-red-50 shadow-lg scale-105' 
                      : 'border-gray-200 hover:border-red-300'
                  }`}
                >
                  <XCircle className={`w-8 h-8 mx-auto mb-2 ${formData.hasInternships === false ? 'text-red-500' : 'text-gray-400'}`} />
                  <div className="font-bold text-center">No</div>
                </button>
              </div>
            </div>

            <div>
              <label className="block text-sm font-semibold text-gray-700 mb-2">Certifications (Optional)</label>
              <textarea
                value={formData.certifications}
                onChange={(e) => updateField('certifications', e.target.value)}
                className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition"
                rows="3"
                placeholder="e.g., AWS Certified, Google Cloud, Coursera ML..."
              />
            </div>
          </div>
        )}

        <div className="flex justify-between mt-8">
          {step > 1 && (
            <button
              type="button"
              onClick={() => setStep(step - 1)}
              className="px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-xl font-semibold hover:bg-gray-50 transition"
            >
              Back
            </button>
          )}
          <button
            type="button"
            onClick={() => {
              if (step < 4) setStep(step + 1);
              else onComplete(formData);
            }}
            disabled={!canProceed()}
            className={`px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-bold hover:shadow-lg hover:scale-[1.02] transition-all flex items-center gap-2 ${
              step === 1 ? 'ml-auto' : ''
            } disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100`}
          >
            {step === 4 ? 'ðŸš€ Complete Setup' : 'Continue'}
            <ArrowRight className="w-4 h-4" />
          </button>
        </div>
      </div>
    </div>
  );
};

// Dashboard with Beautiful Overview
const Dashboard = () => {
  const { user, view, setView, logout, profileData, applications, connectedMentors } = useApp();
  const [sidebarOpen, setSidebarOpen] = useState(false);
  const [generatedRoadmap, setGeneratedRoadmap] = useState(null);
  const [generatingRoadmap, setGeneratingRoadmap] = useState(false);
  const [roadmapError, setRoadmapError] = useState('');

  const navItems = [
    { id: 'overview', label: 'Overview', icon: Target, color: 'text-blue-600' },
    { id: 'roadmap', label: 'Career Roadmap', icon: TrendingUp, color: 'text-purple-600' },
    { id: 'applications', label: 'Applications', icon: BookOpen, color: 'text-green-600' },
    { id: 'mentors', label: 'Mentors', icon: Users, color: 'text-orange-600' },
    { id: 'resume', label: 'Resume Analyzer', icon: FileText, color: 'text-pink-600' },
  ];

  const stats = {
    applications: applications.length,
    interviews: applications.filter(a => a.status === 'interview').length,
    mentors: connectedMentors.length
  };

  const generateRoadmap = async () => {
    setGeneratingRoadmap(true);
    setRoadmapError('');

    const prompt = `You are a career advisor AI. Create a personalized career roadmap for a student with the following profile:

Degree: ${profileData.degree}
Year: ${profileData.year}
Target Role: ${profileData.careerRole}
Skills: ${profileData.skills.join(', ')}
Has Projects: ${profileData.hasProjects ? 'Yes' : 'No'}
Has Internships: ${profileData.hasInternships ? 'Yes' : 'No'}
Certifications: ${profileData.certifications || 'None'}

Create a structured roadmap with 3 phases (each with 3 specific actionable tasks) and 3 next action recommendations.

Return ONLY valid JSON (no markdown, no extra text) in this exact format:
{
  "phases": [
    {"title": "Foundation Phase", "duration": "4 weeks", "tasks": ["task1", "task2", "task3"]},
    {"title": "Advanced Phase", "duration": "6 weeks", "tasks": ["task1", "task2", "task3"]},
    {"title": "Interview Prep Phase", "duration": "4 weeks", "tasks": ["task1", "task2", "task3"]}
  ],
  "nextActions": ["action1", "action2", "action3"]
}`;

    try {
      const content = await callGroqAPI(prompt);
      const cleanContent = content.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
      const roadmapData = JSON.parse(cleanContent);
      setGeneratedRoadmap(roadmapData);
    } catch (error) {
      setRoadmapError(error.message || 'Failed to generate roadmap. Please check your API key and try again.');
    } finally {
      setGeneratingRoadmap(false);
    }
  };

  const OverviewView = () => (
    <div className="space-y-6">
      {/* Hero Section */}
      <div className="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 rounded-3xl p-8 text-white shadow-2xl relative overflow-hidden">
        <div className="absolute top-0 right-0 w-64 h-64 bg-white opacity-10 rounded-full -mr-32 -mt-32"></div>
        <div className="absolute bottom-0 left-0 w-48 h-48 bg-white opacity-10 rounded-full -ml-24 -mb-24"></div>
        <div className="relative z-10">
          <div className="flex items-center gap-3 mb-4">
            <div className="w-16 h-16 bg-white bg-opacity-20 backdrop-blur-lg rounded-2xl flex items-center justify-center">
              <Rocket className="w-8 h-8 text-white" />
            </div>
            <div>
              <h2 className="text-3xl font-bold">Welcome back, {user.name.split(' ')[0]}! ðŸ‘‹</h2>
              <p className="text-purple-100 mt-1">Your AI copilot is ready to accelerate your journey</p>
            </div>
          </div>
        </div>
      </div>

      {/* Stats Grid */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div className="bg-gradient-to-br from-blue-500 to-cyan-500 rounded-2xl p-6 text-white shadow-lg hover:scale-105 transition-transform">
          <div className="flex items-center justify-between mb-4">
            <BookOpen className="w-10 h-10 opacity-80" />
            <div className="text-right">
              <div className="text-4xl font-bold">{stats.applications}</div>
              <div className="text-blue-100 text-sm font-medium">Applications</div>
            </div>
          </div>
          <div className="h-2 bg-white bg-opacity-30 rounded-full overflow-hidden">
            <div className="h-full bg-white rounded-full w-3/4"></div>
          </div>
        </div>

        <div className="bg-gradient-to-br from-green-500 to-emerald-500 rounded-2xl p-6 text-white shadow-lg hover:scale-105 transition-transform">
          <div className="flex items-center justify-between mb-4">
            <CheckCircle className="w-10 h-10 opacity-80" />
            <div className="text-right">
              <div className="text-4xl font-bold">{stats.interviews}</div>
              <div className="text-green-100 text-sm font-medium">Interviews</div>
            </div>
          </div>
          <div className="h-2 bg-white bg-opacity-30 rounded-full overflow-hidden">
            <div className="h-full bg-white rounded-full w-1/2"></div>
          </div>
        </div>

        <div className="bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl p-6 text-white shadow-lg hover:scale-105 transition-transform">
          <div className="flex items-center justify-between mb-4">
            <Users className="w-10 h-10 opacity-80" />
            <div className="text-right">
              <div className="text-4xl font-bold">{stats.mentors}</div>
              <div className="text-purple-100 text-sm font-medium">Mentors</div>
            </div>
          </div>
          <div className="h-2 bg-white bg-opacity-30 rounded-full overflow-hidden">
            <div className="h-full bg-white rounded-full w-2/3"></div>
          </div>
        </div>
      </div>

      {/* Profile Card */}
      <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
        <div className="flex items-center gap-3 mb-6">
          <div className="w-12 h-12 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center">
            <User className="w-6 h-6 text-white" />
          </div>
          <h3 className="text-2xl font-bold text-gray-900">Your Profile</h3>
        </div>
        <div className="grid md:grid-cols-2 gap-6">
          <div className="space-y-4">
            <div className="flex items-start gap-3">
              <GraduationCap className="w-5 h-5 text-indigo-600 mt-1" />
              <div>
                <p className="text-sm font-semibold text-gray-600">Education</p>
                <p className="text-gray-900 font-medium">{profileData.degree}, {profileData.year}</p>
              </div>
            </div>
            <div className="flex items-start gap-3">
              <Target className="w-5 h-5 text-purple-600 mt-1" />
              <div>
                <p className="text-sm font-semibold text-gray-600">Target Role</p>
                <p className="text-gray-900 font-medium">{profileData.careerRole}</p>
              </div>
            </div>
          </div>
          <div>
            <div className="flex items-center gap-2 mb-3">
              <Zap className="w-5 h-5 text-orange-600" />
              <p className="text-sm font-semibold text-gray-600">Skills</p>
            </div>
            <div className="flex flex-wrap gap-2">
              {profileData.skills.map(skill => (
                <span key={skill} className="px-3 py-1.5 bg-gradient-to-r from-indigo-100 to-purple-100 text-indigo-700 rounded-full text-sm font-semibold">
                  {skill}
                </span>
              ))}
            </div>
          </div>
        </div>
      </div>

      {/* Quick Actions */}
      <div className="grid md:grid-cols-2 gap-6">
        <button
          onClick={() => setView('roadmap')}
          className="bg-gradient-to-r from-purple-500 to-pink-500 rounded-2xl p-6 text-white text-left hover:scale-105 transition-transform shadow-lg"
        >
          <Sparkles className="w-10 h-10 mb-3" />
          <h4 className="text-xl font-bold mb-2">Generate AI Roadmap</h4>
          <p className="text-purple-100 text-sm">Get your personalized career path in seconds</p>
        </button>

        <button
          onClick={() => setView('resume')}
          className="bg-gradient-to-r from-orange-500 to-red-500 rounded-2xl p-6 text-white text-left hover:scale-105 transition-transform shadow-lg"
        >
          <FileText className="w-10 h-10 mb-3" />
          <h4 className="text-xl font-bold mb-2">Analyze Resume</h4>
          <p className="text-orange-100 text-sm">Get instant AI feedback on your resume</p>
        </button>
      </div>
    </div>
  );

  const RoadmapView = () => (
    <div className="space-y-6">
      {!generatedRoadmap && (
        <div className="bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 rounded-2xl shadow-2xl p-8 text-white">
          <div className="flex items-center gap-4 mb-6">
            <div className="w-16 h-16 bg-white bg-opacity-20 backdrop-blur-lg rounded-2xl flex items-center justify-center">
              <Sparkles className="w-8 h-8" />
            </div>
            <div>
              <h3 className="text-3xl font-bold">AI-Powered Career Roadmap</h3>
              <p className="text-purple-100 mt-1">Personalized just for you</p>
            </div>
          </div>
          
          {roadmapError && (
            <div className="mb-4 p-4 bg-red-500 bg-opacity-20 border border-red-300 rounded-xl backdrop-blur-lg">
              {roadmapError}
            </div>
          )}

          <button
            onClick={generateRoadmap}
            disabled={generatingRoadmap}
            className="px-8 py-4 bg-white text-purple-600 rounded-xl font-bold text-lg hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-3 shadow-2xl"
          >
            {generatingRoadmap ? (
              <>
                <div className="w-6 h-6 border-4 border-purple-600 border-t-transparent rounded-full animate-spin" />
                Generating your roadmap...
              </>
            ) : (
              <>
                <Sparkles className="w-6 h-6" />
                Generate My Roadmap
              </>
            )}
          </button>
        </div>
      )}

      {generatedRoadmap && (
        <>
          <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
            <div className="flex items-center justify-between mb-6">
              <h3 className="text-2xl font-bold text-gray-900">Your Career Roadmap</h3>
              <span className="px-4 py-2 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-full text-sm font-bold flex items-center gap-2 shadow-lg">
                <Sparkles className="w-4 h-4" />
                AI Generated
              </span>
            </div>

            <div className="space-y-8">
              {generatedRoadmap.phases.map((phase, idx) => (
                <div key={idx} className="relative">
                  {idx !== generatedRoadmap.phases.length - 1 && (
                    <div className="absolute left-6 top-16 bottom-0 w-1 bg-gradient-to-b from-indigo-200 to-purple-200" />
                  )}
                  
                  <div className="flex gap-4">
                    <div className="w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-bold text-lg shadow-lg">
                      {idx + 1}
                    </div>

                    <div className="flex-1 pb-6">
                      <div className="flex items-center justify-between mb-3">
                        <h4 className="text-xl font-bold text-gray-900">{phase.title}</h4>
                        <span className="text-sm font-semibold text-indigo-600 bg-indigo-50 px-3 py-1 rounded-full">{phase.duration}</span>
                      </div>

                      <div className="space-y-3">
                        {phase.tasks.map((task, taskIdx) => (
                          <div key={taskIdx} className="flex items-start gap-3 p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                            <div className="w-6 h-6 rounded-full border-2 border-indigo-300 flex-shrink-0 mt-0.5" />
                            <span className="text-gray-700 font-medium">{task}</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>

          <div className="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl shadow-2xl p-6 text-white">
            <h4 className="text-xl font-bold mb-4 flex items-center gap-2">
              <Target className="w-6 h-6" />
              Next Actions Recommended
            </h4>
            <ul className="space-y-3">
              {generatedRoadmap.nextActions.map((action, idx) => (
                <li key={idx} className="flex items-start gap-3 p-3 bg-white bg-opacity-10 backdrop-blur-lg rounded-lg">
                  <ArrowRight className="w-5 h-5 flex-shrink-0 mt-0.5" />
                  <span className="font-medium">{action}</span>
                </li>
              ))}
            </ul>
          </div>
        </>
      )}
    </div>
  );

  const ApplicationsView = () => {
    const [filter, setFilter] = useState('all');
    const [search, setSearch] = useState('');

    const filtered = applications.filter(app => {
      const matchesFilter = filter === 'all' || app.status === filter;
      const matchesSearch = app.company.toLowerCase().includes(search.toLowerCase()) ||
                           app.role.toLowerCase().includes(search.toLowerCase());
      return matchesFilter && matchesSearch;
    });

    const statsData = {
      total: applications.length,
      applied: applications.filter(a => a.status === 'applied').length,
      interview: applications.filter(a => a.status === 'interview').length,
      rejected: applications.filter(a => a.status === 'rejected').length
    };

    return (
      <div className="space-y-6">
        <div className="flex items-center justify-between">
          <h3 className="text-3xl font-bold text-gray-900">Application Tracker</h3>
          <button className="px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-bold hover:scale-105 transition-transform flex items-center gap-2 shadow-lg">
            <Plus className="w-5 h-5" />
            Add Application
          </button>
        </div>

        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div className="bg-white rounded-xl shadow-md p-5 border-l-4 border-blue-500">
            <div className="text-sm font-semibold text-gray-600 mb-1">Total</div>
            <div className="text-3xl font-bold text-gray-900">{statsData.total}</div>
          </div>
          <div className="bg-white rounded-xl shadow-md p-5 border-l-4 border-yellow-500">
            <div className="text-sm font-semibold text-gray-600 mb-1">Applied</div>
            <div className="text-3xl font-bold text-gray-900">{statsData.applied}</div>
          </div>
          <div className="bg-white rounded-xl shadow-md p-5 border-l-4 border-green-500">
            <div className="text-sm font-semibold text-gray-600 mb-1">Interviews</div>
            <div className="text-3xl font-bold text-gray-900">{statsData.interview}</div>
          </div>
          <div className="bg-white rounded-xl shadow-md p-5 border-l-4 border-red-500">
            <div className="text-sm font-semibold text-gray-600 mb-1">Rejected</div>
            <div className="text-3xl font-bold text-gray-900">{statsData.rejected}</div>
          </div>
        </div>

        <div className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100">
          <div className="flex flex-col md:flex-row gap-4 mb-6">
            <div className="flex-1 relative">
              <Search className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" />
              <input
                type="text"
                value={search}
                onChange={(e) => setSearch(e.target.value)}
                placeholder="Search companies or roles..."
                className="w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition"
              />
            </div>
            <div className="flex gap-2">
              {['all', 'applied', 'interview', 'rejected'].map(f => (
                <button
                  key={f}
                  onClick={() => setFilter(f)}
                  className={`px-4 py-2 rounded-xl font-semibold transition ${
                    filter === f
                      ? 'bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg'
                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                  }`}
                >
                  {f.charAt(0).toUpperCase() + f.slice(1)}
                </button>
              ))}
            </div>
          </div>

          <div className="space-y-3">
            {filtered.map(app => (
              <div key={app.id} className="flex items-center justify-between p-4 bg-gray-50 rounded-xl hover:bg-gray-100 transition">
                <div className="flex items-center gap-4">
                  <div className="w-12 h-12 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center text-white font-bold">
                    {app.company.charAt(0)}
                  </div>
                  <div>
                    <div className="font-bold text-gray-900">{app.company}</div>
                    <div className="text-sm text-gray-600">{app.role}</div>
                  </div>
                </div>
                <div className="flex items-center gap-4">
                  <span className="text-sm text-gray-500">{app.date}</span>
                  <span className={`px-4 py-2 rounded-full text-sm font-bold ${
                    app.status === 'rejected' ? 'bg-red-100 text-red-700' :
                    app.status === 'interview' ? 'bg-green-100 text-green-700' :
                    'bg-blue-100 text-blue-700'
                  }`}>
                    {app.status.charAt(0).toUpperCase() + app.status.slice(1)}
                  </span>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    );
  };

  const MentorsView = () => {
    const [showAvailable, setShowAvailable] = useState(false);
    const { connectedMentors, setConnectedMentors } = useApp();

    const handleConnect = (mentor) => {
      setConnectedMentors(prev => [...prev, { ...mentor, status: 'connected', lastAdvice: null }]);
      setShowAvailable(false);
    };

    return (
      <div className="space-y-6">
        <div className="flex items-center justify-between">
          <h3 className="text-3xl font-bold text-gray-900">Your Mentor Network</h3>
          <button
            onClick={() => setShowAvailable(!showAvailable)}
            className="px-6 py-3 bg-gradient-to-r from-orange-600 to-red-600 text-white rounded-xl font-bold hover:scale-105 transition-transform flex items-center gap-2 shadow-lg"
          >
            <Plus className="w-5 h-5" />
            Connect to New Mentors
          </button>
        </div>

        {showAvailable && (
          <div className="bg-gradient-to-r from-orange-50 to-red-50 rounded-2xl p-6 border-2 border-orange-200">
            <h4 className="text-2xl font-bold text-gray-900 mb-4">Available Mentors</h4>
            <div className="grid gap-4">
              {AVAILABLE_MENTORS.filter(m => !connectedMentors.find(c => c.id === m.id)).map(mentor => (
                <div key={mentor.id} className="bg-white rounded-xl p-5 shadow-md border border-gray-200 hover:shadow-lg transition">
                  <div className="flex items-start gap-4">
                    <div className="w-14 h-14 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl flex items-center justify-center text-white text-xl font-bold">
                      {mentor.avatar}
                    </div>
                    <div className="flex-1">
                      <h5 className="font-bold text-gray-900 text-lg">{mentor.name}</h5>
                      <p className="text-sm text-gray-600 mb-2">{mentor.role}</p>
                      <div className="flex flex-wrap gap-2 mb-2">
                        {mentor.expertise.map(skill => (
                          <span key={skill} className="px-2 py-1 bg-orange-100 text-orange-700 rounded-lg text-xs font-semibold">
                            {skill}
                          </span>
                        ))}
                      </div>
                      <p className="text-sm text-gray-500">{mentor.experience} experience</p>
                    </div>
                    <button
                      onClick={() => handleConnect(mentor)}
                      className="px-5 py-2 bg-gradient-to-r from-orange-600 to-red-600 text-white rounded-lg text-sm font-bold hover:scale-105 transition-transform shadow"
                    >
                      Connect
                    </button>
                  </div>
                </div>
              ))}
            </div>
          </div>
        )}

        <div className="grid gap-4">
          {connectedMentors.map(mentor => (
            <div key={mentor.id} className="bg-white rounded-2xl shadow-lg p-6 border border-gray-100 hover:shadow-xl transition">
              <div className="flex items-start gap-4">
                <div className="w-16 h-16 bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl flex items-center justify-center text-white text-2xl font-bold shadow-lg">
                  {mentor.avatar}
                </div>
                <div className="flex-1">
                  <div className="flex items-start justify-between mb-3">
                    <div>
                      <h4 className="text-xl font-bold text-gray-900">{mentor.name}</h4>
                      <p className="text-sm text-gray-600">{mentor.role}</p>
                    </div>
                    <span className="px-4 py-1.5 bg-green-100 text-green-700 rounded-full text-xs font-bold">
                      Connected
                    </span>
                  </div>

                  <div className="flex flex-wrap gap-2 mb-4">
                    {mentor.expertise.map(skill => (
                      <span key={skill} className="px-3 py-1 bg-purple-100 text-purple-700 rounded-lg text-sm font-semibold">
                        {skill}
                      </span>
                    ))}
                  </div>

                  <div className="flex gap-3">
                    <button className="flex-1 px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg font-semibold hover:scale-105 transition-transform shadow">
                      Message
                    </button>
                    <button className="flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg font-semibold hover:bg-gray-200 transition">
                      Schedule Call
                    </button>
                  </div>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  };

  const ResumeAnalyzerView = () => {
    const [file, setFile] = useState(null);
    const [analyzing, setAnalyzing] = useState(false);
    const [analysis, setAnalysis] = useState(null);
    const [error, setError] = useState('');

    const analyzeResume = async () => {
      if (!file) {
        setError('Please upload a resume first');
        return;
      }

      setAnalyzing(true);
      setError('');

      const prompt = `Analyze this resume and provide:
1. Overall score out of 10
2. Three key strengths
3. Three areas for improvement
4. Three specific action items to improve

Return ONLY valid JSON (no markdown) in this format:
{
  "score": 7.5,
  "strengths": ["strength1", "strength2", "strength3"],
  "improvements": ["improvement1", "improvement2", "improvement3"],
  "actionItems": ["action1", "action2", "action3"]
}`;

      try {
        const content = await callGroqAPI(prompt, 1000);
        const cleanContent = content.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
        const analysisData = JSON.parse(cleanContent);
        setAnalysis(analysisData);
      } catch (err) {
        setError(err.message || 'Failed to analyze resume');
      } finally {
        setAnalyzing(false);
      }
    };

    return (
      <div className="space-y-6">
        <h3 className="text-3xl font-bold text-gray-900">AI Resume Analyzer</h3>

        <div className="bg-white rounded-2xl shadow-lg p-8 border border-gray-100">
          <div className="mb-6">
            <label className="block text-sm font-bold text-gray-700 mb-3">Upload Your Resume</label>
            <div className="border-3 border-dashed border-indigo-300 rounded-2xl p-10 text-center bg-gradient-to-br from-indigo-50 to-purple-50 hover:border-indigo-500 transition">
              <Upload className="w-16 h-16 text-indigo-400 mx-auto mb-4" />
              <input
                type="file"
                accept=".pdf"
                onChange={(e) => setFile(e.target.files[0])}
                className="hidden"
                id="resume-upload"
              />
              <label htmlFor="resume-upload" className="cursor-pointer">
                <span className="text-indigo-600 font-bold text-lg hover:underline">Click to upload</span>
                <span className="text-gray-600"> or drag and drop</span>
              </label>
              <p className="text-sm text-gray-500 mt-2">PDF up to 10MB</p>
            </div>
            {file && (
              <div className="mt-4 flex items-center gap-3 p-4 bg-green-50 border-2 border-green-200 rounded-xl">
                <FileText className="w-6 h-6 text-green-600" />
                <span className="font-semibold text-green-900">{file.name}</span>
              </div>
            )}
          </div>

          {error && (
            <div className="mb-4 p-4 bg-red-50 border-l-4 border-red-500 rounded-xl text-red-700 font-medium">
              {error}
            </div>
          )}

          <button
            onClick={analyzeResume}
            disabled={!file || analyzing}
            className="w-full px-8 py-4 bg-gradient-to-r from-pink-600 to-red-600 text-white rounded-xl font-bold text-lg hover:scale-105 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 shadow-2xl"
          >
            {analyzing ? (
              <>
                <div className="w-6 h-6 border-4 border-white border-t-transparent rounded-full animate-spin" />
                Analyzing your resume...
              </>
            ) : (
              <>
                <Sparkles className="w-6 h-6" />
                Analyze Resume
              </>
            )}
          </button>
        </div>

        {analysis && (
          <div className="space-y-6">
            <div className="bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl shadow-2xl p-8 text-white">
              <div className="text-center">
                <Award className="w-16 h-16 mx-auto mb-4 opacity-80" />
                <div className="text-6xl font-bold mb-2">{analysis.score}/10</div>
                <div className="text-green-100 text-lg font-semibold">Overall Resume Score</div>
              </div>
            </div>

            <div className="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-green-500">
              <h4 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                <CheckCircle className="w-6 h-6 text-green-500" />
                Strengths
              </h4>
              <ul className="space-y-3">
                {analysis.strengths.map((strength, idx) => (
                  <li key={idx} className="flex items-start gap-3 p-3 bg-green-50 rounded-lg">
                    <span className="text-green-600 font-bold text-xl">âœ“</span>
                    <span className="text-gray-700 font-medium">{strength}</span>
                  </li>
                ))}
              </ul>
            </div>

            <div className="bg-white rounded-2xl shadow-lg p-6 border-l-4 border-orange-500">
              <h4 className="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                <TrendingUp className="w-6 h-6 text-orange-500" />
                Areas for Improvement
              </h4>
              <ul className="space-y-3">
                {analysis.improvements.map((improvement, idx) => (
                  <li key={idx} className="flex items-start gap-3 p-3 bg-orange-50 rounded-lg">
                    <span className="text-orange-600 font-bold text-xl">â†’</span>
                    <span className="text-gray-700 font-medium">{improvement}</span>
                  </li>
                ))}
              </ul>
            </div>

            <div className="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl shadow-2xl p-6 text-white">
              <h4 className="text-xl font-bold mb-4 flex items-center gap-2">
                <Target className="w-6 h-6" />
                Action Items
              </h4>
              <ul className="space-y-3">
                {analysis.actionItems.map((action, idx) => (
                  <li key={idx} className="flex items-start gap-3 p-3 bg-white bg-opacity-10 backdrop-blur-lg rounded-lg">
                    <span className="font-bold text-xl">{idx + 1}.</span>
                    <span className="font-medium">{action}</span>
                  </li>
                ))}
              </ul>
            </div>
          </div>
        )}
      </div>
    );
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100">
      {/* Header */}
      <header className="bg-white border-b border-gray-200 sticky top-0 z-50 shadow-sm">
        <div className="px-4 sm:px-6 lg:px-8">
          <div className="flex items-center justify-between h-16">
            <div className="flex items-center gap-3">
              <button 
                onClick={() => setSidebarOpen(!sidebarOpen)}
                className="lg:hidden p-2 rounded-xl hover:bg-gray-100 transition"
              >
                {sidebarOpen ? <X className="w-6 h-6" /> : <Menu className="w-6 h-6" />}
              </button>
              <div className="flex items-center gap-2">
                <div className="w-10 h-10 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center">
                  <Target className="w-6 h-6 text-white" />
                </div>
                <span className="text-xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 text-transparent bg-clip-text">
                  Career Copilot
                </span>
              </div>
            </div>
            
            <div className="flex items-center gap-4">
              <div className="hidden sm:flex items-center gap-3 px-4 py-2 bg-gray-50 rounded-xl">
                <div className="w-10 h-10 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-full flex items-center justify-center text-white font-bold">
                  {user.name.charAt(0)}
                </div>
                <div className="text-left">
                  <p className="text-sm font-bold text-gray-900">{user.name}</p>
                  <p className="text-xs text-gray-500">{user.email}</p>
                </div>
              </div>
              <button 
                onClick={logout}
                className="p-2.5 text-gray-600 hover:bg-red-50 hover:text-red-600 rounded-xl transition"
                title="Logout"
              >
                <LogOut className="w-5 h-5" />
              </button>
            </div>
          </div>
        </div>
      </header>

      <div className="flex">
        {/* Sidebar */}
        <aside className={`${
          sidebarOpen ? 'translate-x-0' : '-translate-x-full'
        } lg:translate-x-0 fixed lg:static inset-y-0 left-0 z-40 w-64 bg-white border-r border-gray-200 transition-transform duration-300 ease-in-out mt-16 lg:mt-0 shadow-xl lg:shadow-none`}>
          <nav className="p-4 space-y-2">
            {navItems.map(item => (
              <button
                key={item.id}
                onClick={() => {
                  setView(item.id);
                  setSidebarOpen(false);
                }}
                className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl text-left transition-all ${
                  view === item.id
                    ? 'bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg scale-105'
                    : 'text-gray-700 hover:bg-gray-50 hover:scale-102'
                }`}
              >
                <item.icon className={`w-5 h-5 ${view === item.id ? 'text-white' : item.color}`} />
                <span className="font-semibold">{item.label}</span>
              </button>
            ))}
          </nav>
        </aside>

        {/* Main Content */}
        <main className="flex-1 p-4 sm:p-6 lg:p-8">
          <div className="max-w-7xl mx-auto">
            {view === 'overview' && <OverviewView />}
            {view === 'roadmap' && <RoadmapView />}
            {view === 'applications' && <ApplicationsView />}
            {view === 'mentors' && <MentorsView />}
            {view === 'resume' && <ResumeAnalyzerView />}
          </div>
        </main>
      </div>
    </div>
  );
};

// Main App
export default function App() {
  const [appState, setAppState] = useState('landing');
  const [view, setView] = useState('overview');
  const [user, setUser] = useState(null);
  const [profileData, setProfileData] = useState(null);
  const [connectedMentors, setConnectedMentors] = useState([
    {
      id: 'm1',
      name: 'Priya Sharma',
      role: 'Senior SDE at Microsoft',
      avatar: 'PS',
      expertise: ['System Design', 'Cloud', 'Interview Prep'],
      matchReason: 'Works at FAANG, strong in system design',
      status: 'connected'
    }
  ]);

  const contextValue = {
    user,
    profileData,
    applications: SAMPLE_APPLICATIONS,
    connectedMentors,
    setConnectedMentors,
    view,
    setView,
    logout: () => {
      setAppState('landing');
      setUser(null);
      setProfileData(null);
    }
  };

  return (
    <AppContext.Provider value={contextValue}>
      {appState === 'landing' && <LandingPage onGetStarted={() => setAppState('auth')} />}
      {appState === 'auth' && (
        <AuthPage onAuthSuccess={(userData) => {
          setUser(userData);
          setAppState('onboarding');
        }} />
      )}
      {appState === 'onboarding' && (
        <Onboarding 
          userName={user.name} 
          onComplete={(data) => {
            setProfileData(data);
            setAppState('dashboard');
          }} 
        />
      )}
      {appState === 'dashboard' && <Dashboard />}
    </AppContext.Provider>
  );
}